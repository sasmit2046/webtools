<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>TypeShala Nepali Typing</title>

<style>
body{
  margin:0;
  font-family:"Kalimati","Mangal",Arial,sans-serif;
  background:#e6e6e6;
}

.header{
  background:#2e7d32;
  color:white;
  padding:12px;
  text-align:center;
  font-size:20px;
}

.container{
  width:900px;
  margin:20px auto;
  background:white;
  padding:20px;
  border:1px solid #999;
}

.lesson{
  border:1px solid #999;
  padding:15px;
  font-size:22px;
  line-height:1.8;
  min-height:90px;
}

.lesson span.correct{color:green;}
.lesson span.wrong{color:red;}
.lesson span.active{background:#c8e6c9;}

textarea{
  width:100%;
  height:140px;
  font-size:20px;
  padding:10px;
  margin-top:15px;
  border:1px solid #999;
  resize:none;
}

.stats{
  display:flex;
  justify-content:space-between;
  margin-top:15px;
  font-size:16px;
  background:#f5f5f5;
  padding:10px;
  border:1px solid #ccc;
}

.footer{
  text-align:center;
  font-size:14px;
  margin-top:10px;
}
</style>
</head>

<body>

<div class="header">
  Nepali TypeShala – Unicode Typing Practice
</div>

<div class="container">

  <div id="lesson" class="lesson"></div>

  <textarea id="typing" placeholder="यहाँ टाइप गर्नुहोस्..."></textarea>

  <div class="stats">
    <div>Time: <span id="time">0</span> sec</div>
    <div>Speed: <span id="wpm">0</span> WPM</div>
    <div>Accuracy: <span id="accuracy">100</span>%</div>
  </div>

  <div class="footer">
    Press Backspace to correct mistakes
  </div>

</div>

<script>
const lessonText =
"नेपाल एक सुन्दर देश हो। यहाँ हिमाल, पहाड र तराई छन्। हामी सबैले आफ्नो भाषा र संस्कृतिको संरक्षण गर्नुपर्छ।";

const lessonDiv = document.getElementById("lesson");
const typing = document.getElementById("typing");

let startTime=null;
let timer=null;

function render(text=""){
  lessonDiv.innerHTML="";
  for(let i=0;i<lessonText.length;i++){
    let span=document.createElement("span");
    span.textContent=lessonText[i];

    if(i<text.length){
      span.className = text[i]===lessonText[i] ? "correct" : "wrong";
    }
    if(i===text.length){
      span.classList.add("active");
    }
    lessonDiv.appendChild(span);
  }
}
render();

typing.addEventListener("input",()=>{
  if(!startTime){
    startTime=new Date();
    timer=setInterval(updateTime,1000);
  }
  render(typing.value);
  updateStats();
});

function updateTime(){
  document.getElementById("time").textContent =
    Math.floor((new Date()-startTime)/1000);
}

function updateStats(){
  let typed=typing.value;
  let correct=0;

  for(let i=0;i<typed.length;i++){
    if(typed[i]===lessonText[i]) correct++;
  }

  let accuracy = typed.length
    ? Math.round((correct/typed.length)*100)
    : 100;

  let minutes=(new Date()-startTime)/60000;
  let wpm = minutes>0 ? Math.round((typed.length/5)/minutes) : 0;

  document.getElementById("accuracy").textContent=accuracy;
  document.getElementById("wpm").textContent=wpm;
}
</script>

</body>
</html>
